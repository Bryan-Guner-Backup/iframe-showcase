<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<h1 id="buffer-writer">buffer-writer</h1>
<p><a href="http://travis-ci.org/brianc/node-buffer-writer"><img src="https://secure.travis-ci.org/brianc/node-buffer-writer.png?branch=master" alt="Build Status" /></a></p>
<p>Fast &amp; efficient buffer writer used to keep memory usage low by internally recycling a single large buffer.</p>
<p>Used as the binary protocol writer in <a href="https://github.com/brianc/node-postgres">node-postgres</a></p>
<p>Since postgres requires big endian encoding, this only writes big endian numbers for now, but can &amp; probably will easily be extended to write little endian as well.</p>
<p>I’ll admit this has a few postgres specific things I might need to take out in the future, such as <code>addHeader</code></p>
<h2 id="api">api</h2>
<p><code>var writer = new (require('buffer-writer')());</code></p>
<h3 id="writer.addint32num">writer.addInt32(num)</h3>
<p>Writes a 4-byte big endian binary encoded number to the end of the buffer.</p>
<h3 id="writer.addint16num">writer.addInt16(num)</h3>
<p>Writes a 2-byte big endian binary encoded number to the end of the buffer.</p>
<h3 id="writer.addcstringstring">writer.addCString(string)</h3>
<p>Writes a string to the buffer <code>utf8</code> encoded and adds a null character (<code>\0</code>) at the end.</p>
<h3 id="var-buffer-writer.addheaderchar">var buffer = writer.addHeader(char)</h3>
<p>Writes the 5 byte PostgreSQL required header to the beginning of the buffer. (1 byte for character, 1 BE Int32 for length of the buffer)</p>
<h3 id="var-buffer-writer.join">var buffer = writer.join()</h3>
<p>Collects all data in the writer and joins it into a single, new buffer.</p>
<h3 id="var-buffer-writer.flushchar">var buffer = writer.flush(char)</h3>
<p>Writes the 5 byte postgres required message header, collects all data in the writer and joins it into a single, new buffer, and then resets the writer.</p>
<h2 id="thoughts">thoughts</h2>
<p>This is kind of node-postgres specific. If you’re interested in using this for a more general purpose thing, lemme know. I would love to work with you on getting this more reusable for your needs.</p>
<h2 id="license">license</h2>
<p>MIT</p>
</body>
</html>
